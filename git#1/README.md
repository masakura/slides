# Git 勉強会


## やりたいこと
* トピックブランチで作業すると急なお願いにも対応できるよ
* 歴史の改ざんを使うと、作業の整理ができるよ

`git commit` や `git push` が分からない人は対象外です。


## スライド案


### 自己紹介 & アジェンダ


### その前に
みなさんはこんなことでお困りじゃないでしょうか?

* ホームページのそこそこ大変な修正中に、お客さんからちょこっとだけ修正してよ! 今すぐ!

こういった場合どうします?

手元のホームページのソースコードはすでに修正中で、元に戻せるような状態ではありません。また、運悪くバックアップを取ってませんでした。

サーバーからソースコードを取得して書き換えてまたサーバーへアップロードしました。

そして、作業中のものが完成してサーバーへアップロードしました。

これで一息つける! と安心したのもつかの間... お客さんから電話が! 「前お願いしてた修正が消えてるんだけど!」

トピックブランチを使うことで、このような場合に対処がしやすくなります。


### トピックブランチを作る
バージョン管理システムにはブランチという枝を作る機能があります。トピックブランチとは、一つの作業ごとにこの枝を作っていく方法です。

先ほどの例だと、作業中だった変更を開始する前にトピックブランチを作成します。

```
git checkout -b topic1
```

今、どのようなブランチがあるかは `git branch` で、今どのブランチなのかは `git status` で確認できます。

ブランチができたので作業を開始します。

* お客さんから、このちょこっとした修正を急ぎでお願い!

でも安心です。ひとまず現在の作業を全部コミットしちゃいましょう。

```
git add .
git commit
```

そして `master` ブランチに切り替え、作業前の状態に切り替えます。

```
git checkout master
```

お客さんから言われた急ぎの修正のトピックブランチを作成します。

```
git checkout -b topic2
```

修正を行い、コミットをします。

```
git add .
git commit
```

最後にもう一度確認して、問題がなければ、`topic2` トピックブランチの変更を `master` ブランチにマージします。

```
git checkout master
git merge topic2
```

不要になった `topic2` トピックブランチを削除します。

```
git branch -d topic2
```

これをサーバーへアップロードします。

急ぎの仕事は終わりました!

もともとやってた作業に戻ります。

```
git checkout topic1
```

忘れないうちに、急な修正の内容をマージします。

```
git merge master
```

そして、作業の続きを行います。

完了したらコミットします。

```
git add .
git commit
```

問題がなければ `master` ブランチにマージします。

```
git checkout master
git merge topic1
```

不要になった `topic1` トピックブランチを削除します。

```
git branch -d topic1
```

こんな感じで作業することで、急な作業依頼にも対応することができます。

トピックブランチで作業すると...

* 急な割り込みに対応できるようになる
* 作ってみたはいいけど捨てたいな、これ、が簡単にできる
* お客さんに修正案を見せる時も便利そう


### 歴史の改ざん
Git の歴史の改ざんはさまざまなことができて、たくさんあるので今日はちょっとだけの紹介に留めます。

一つ目は `commit` 時に `--amend` 引数を付ける方法。直前のコミットをやり直すことができます。

* コミットログの間違いの修正
* コミット対象に含めるのを忘れたファイルの追加

もう一つが、こちらがたくさん機能があるんですが、`git rebase -i` です。

こちらは過去のコミットをやり直すことができます。ただし、やり直しでコミットしたリビジョン以降、リビジョン ID が変わることに注意してください。

二つのコミットを一つに統合したり、一つのコミットを複数のコミットに分割したり、特定のコミットに別の変更を行ったりします。

過去のコミットでスペルミスを発見した時、これを修正することができます。もちろん、スペルミスを修正した新しいコミットをしてもいいのですが、その分コミットログが読みにくくなってしまいます。

まだ他人に公開していないコミットならば、過去のコミットを修正しちゃいましょう!


## オススメ
絵で騙されるけど、サルでもわかる Git 入門の発展編は大変参考になります!

もう一つ、ぜひ読んでおきたいのが Git の公式ドキュメント ProGit です。有志によって翻訳されたものが公開されています。なかなかハードな内容ですが、バージョン管理ツールをコミュニケーションツールとして捉えると、読んでみる価値があるかもしれません。
